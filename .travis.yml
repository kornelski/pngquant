language: c
sudo: required

os:
  - linux
  - osx

before_install:
  - if [[ $TRAVIS_OS_NAME = "osx" ]]; then brew install lcms2; fi
  - if [[ $TRAVIS_OS_NAME = "linux" ]]; then curl https://nixos.org/nix/install | sh &&
                                             . ~/.nix-profile/etc/profile.d/nix.sh &&
                                             nix-env -i libpng; fi

script:
  - ./configure --with-lcms2
  - make
  - make test
